# Лабораторная работа №1: Перемножение матриц
## Описание работы
### Цели
1.	Научиться работать в IDE Visual Studio.
2.	Отработать навык создания программы на C#.
3.	Посмотреть выброс исключение платформой .NET и управление памятью, в том числе «сборку мусора».
4.	Получить навык отладки программы.

### Задание
Написать консольную программу, выполняющую в бесконечном цикле создание двух случайных матриц, их перемножение и вывод суммы элементов результирующей матрицы.
Алгоритм программы:
1.	Считать с консоли целое число N.
2.	Начало бесконечного цикла.
3.	Создать две матрицы A и B размером NxN каждая с типом элементов decimal. Каждый элемент матрицы должен быть случайным числом в интервале [0,1].
4.	Вычислить C=A*B. Умножение матричное, а не поэлементное.
5.	Вывести на экран сумму элементов матрицы C.
6.	Подождать 10 мс.
7.	Конец бесконечного цикла.
Память для матриц должна выделяться внутри бесконечного цикла.

### Демонстрация работы
1.	Ввести  в качестве числа N значение, не являющееся числом.
2.	Ввести в качестве N очень большое число (например, 100000).
3.	Ввести N=500, запустить менеджер задач Windows, посмотреть на выделение памяти процессу программы.
4.	Поставить точку останова на строке с паузой (пункт 6 алгоритма) со следующим условием: останавливать, если верхний левый элемент результирующей матрицы C меньше 0.5.

## Выполнение работы
### Описание кода
1.  Считываем с консоли строку в бесконечном цикле.
2.  Проверяем, что пользователь ввёл число, иначе выводим сообщение об ошибке и повторяем пункт 1.
```C#
int N = 0;
while (true)
{
    while (N == 0)
    {
        try
        {
            Console.Write("N = ");
            N = int.Parse(Console.ReadLine());
            break;
        }
        catch (Exception ex)
        {
            Console.WriteLine(ex.Message);
        }
    }
...
```
3.  Для создания рандомных матриц будем использовать отдельную функцию.
```C#
private static decimal[,] CreateRandomMatrix(int N)
{
    decimal[,] matrix = new decimal[N, N];

    for (int i = 0; i < N; i++)
    {
        for (int j = 0; j < N; j++)
        {
            matrix[i, j] = rand.Next(0, 2);
        }
    }
    
    return matrix;
}
```
4.  Для вычисления матричного умножения также напишем отдельную функцию.
```C#
private static decimal[,] MatrixMultiplication(decimal[,] A, decimal[,] B)
{
    decimal[,] C = new decimal[A.GetLength(0), A.GetLength(0)];

    for (int i = 0; i < C.GetLength(0); i++)
    {
        for (int j = 0; j < C.GetLength(0); j++)
        {
            C[i, j] = 0;
            for (int r = 0; r < C.GetLength(0); r++)
            {
                C[i, j] += A[i, r] * B[r, j];
            }
        }
    }

    return C;
}
```
5.  Функция для вычисления суммы всех элементов матрицы.
```C#
private static decimal MatrixSum(decimal[,] matrix)
{
    decimal matrixSum = 0;

    for (int i = 0; i < matrix.GetLength(0); i++)
    {
        for (int j = 0; j < matrix.GetLength(0); j++)
        {
            matrixSum += matrix[i, j];
        }
    }

    return matrixSum;
}
```
6. Теперь можно объеденить все функции в один блок для циклического создания матриц. Выход из цикла будет происходить при условии, если верхний левый элемент результирующей матрицы C меньше 0.5.<br><br>
Код находится внутри блока while (true)
```C#
...
try { 
    decimal[,] A = CreateRandomMatrix(N);
    decimal[,] B = CreateRandomMatrix(N);

    decimal[,] C = MatrixMultiplication(A, B);

    Console.WriteLine("Matrix Sum = " + MatrixSum(C));

    Thread.Sleep(10);
    if (Decimal.ToDouble(C[0, 0]) < 0.5)
    {
        break;
    }
}
catch (Exception ex)
{
    Console.WriteLine(ex.Message);
    N = 0;
}
...
```

### Демонстрация работы
1.  Проверка ошибоки ввода. <br>
![](resources/exceptions.gif)
2.  Проверка ошибоки нехватки памяти. <br>
![](resources/memory.gif)
3.  Выделение памяти процессу при N = 500 <br>
![](resources/manager.gif)
4.  Проверка условия остановки цикла. <br>
Выполним для небольшой матрицы, чтобы была больше вероятность остановки. <br>
![](resources/stop.gif)
